---
title: "Homework 5"
author: "Daniel"
date: "10/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## College Tuition Numeric Variables

### Setup
```{r}
library(purrr) # recommend keep()/discharge() and map_dbl()
library(dplyr)
library(tidyr)
library(ggplot2)
library(knitr)
library(scales)

load('college_scorecard.Rda')
df_new <- df
df_new$npt <- df_new$npt4_priv
df_new$npt[is.na(df_new$npt)] <- df_new$npt4_pub[is.na(df_new$npt)]
df_new <- df_new %>% filter(!is.na(df_new$npt))
df_new$control <- factor(df_new$control,level = 1:3,labels = c('public','private','for_profit'))
df_new$public <- as.numeric(df_new$control=='public')
df_new <- df_new %>% select(-distanceonly)

# Questions
#1. 
colleges_excluded <- nrow(df) - nrow(df_new)
colleges_remaining <- percent(nrow(df_new)/nrow(df))

#2. 
df_num <- df_new %>% keep(is.numeric) %>% pivot_longer(names_to='key', values_to ='value', -npt)

plot1 <- ggplot(df_num, aes(x=value, y=npt)) + geom_point(alpha=.2,size=1) + facet_wrap(~key, scales='free') 
#3. 
coef <- df_num %>% group_by(key) %>% summarise(coefficient = cor(npt, value, use='complete.obs')) %>% mutate(rank=dense_rank(1-abs(coefficient))) %>% arrange(rank)
```

## Questions
1. How many colleges were excluded and what is the percentage of colleges remaining in the analysis?

Number of colleges were excluded:`r colleges_excluded`

Percentage of colleges remaining: `r colleges_remaining`

2.What numeric variables are shown to have a linear relationship or recognizable pattern with npt?

```{r, fig.width=15,fig.height=12}
plot1
```

3. What numeric variables have the strongest linear correlation with npt?

Correlation between numeric variables and npt

`r kable(coef)`

#### 4. Although npt4_priv and npt4_pub has the coefficient 1.0, they are practically the same as npt, so we are not going to pick them. Instead the public is a better choice. Next one could either be actcm25 or actcm75. They both represent act score and has almost the same coefficient. The final one should be md_earn_wne_p8 cause they have the highest coefficient among the three md_earn.