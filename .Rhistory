library(tidyverse)
df <- Seatbelts
df
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram()
df <- data.frame(df)
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram()
plot1
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20)
plot1
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 50)
plot1
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 30, binwidth = 20)
plot1
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 30, binwidth = 100)
plot1
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 30, binwidth = 5)
plot1
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 10)
plot1
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20)
plot1
?Seatbelts
df
library(tidyverse)
df <- Seatbelts
df <- data.frame(df)
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20)
df <- data.frame(as.matrix(Seatbelts), date=time(Seatbelts))
df$year <- trunc(df$date)
df$month <- (df$date - df$year) * 12 + 1
df
plot2 <- ggplot(data=df, mapping = aes(x=date, y=Driverskilled)) + geom_line()
plot2
df
plot2 <- ggplot(data=df, mapping = aes(x=date, y=DriversKilled)) + geom_line()
plot2
df
df[df$date > 1983]
select(df, date>1983)
filter(df, date>1983)
?rep
plot2_short <- ggplot(data=df_short, mapping = aes(x=month, y=DriversKilled)) + geom_line()
library(tidyverse)
df <- Seatbelts
df <- data.frame(df)
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20)
df <- data.frame(as.matrix(Seatbelts), date=time(Seatbelts))
df$year <- trunc(df$date)
df$month <- (df$date - df$year) * 12 + 1
df_short = filter(df, date>=1983)
df_short <- mutate(df_short, month=rep(month.abb,2))
plot2_short <- ggplot(data=df_short, mapping = aes(x=month, y=DriversKilled)) + geom_line()
plot2_short
df_short
df_short <- mutate(df_short, time = year + rep(month.abb,2))
df$year
plot2_short <- ggplot(data=df_short, mapping = aes(x=year, y=DriversKilled)) + geom_line()
plot2_short
?Seatbelts
?UKDriverDeaths
?c
?UKDriverDeaths
plot3 <- ggplot(data=df, mapping = aes(x=Driverskilled, y=law)) + geom_boxplot()
plot3
library(tidyverse)
df <- Seatbelts
df <- data.frame(df)
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20)
df <- data.frame(as.matrix(Seatbelts), date=time(Seatbelts))
df$year <- trunc(df$date)
df$month <- (df$date - df$year) * 12 + 1
df_short = filter(df, date>=1983)
df_short <- mutate(df_short, time = year + rep(month.abb,2))
plot2_short <- ggplot(data=df_short, mapping = aes(x=year, y=DriversKilled)) + geom_line()
plot3 <- ggplot(data=df, mapping = aes(x=DriversKilled, y=law)) + geom_boxplot()
plot3
plot3 <- ggplot(data=df, mapping = aes(x=law, y=Driverskilled)) + geom_boxplot()
plot3
df
plot3 <- ggplot(data=df, mapping = aes(x=law, y=DriversKilled )) + geom_boxplot()
plot3
library(tidyverse)
df <- Seatbelts
df <- data.frame(df)
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20)
df <- data.frame(as.matrix(Seatbelts), date=time(Seatbelts))
df$year <- trunc(df$date)
df$month <- (df$date - df$year) * 12 + 1
df_short = filter(df, date>=1983)
df_short <- mutate(df_short, time = year + rep(month.abb,2))
plot2_short <- ggplot(data=df_short, mapping = aes(x=year, y=DriversKilled)) + geom_line()
plot3 <- ggplot(data=df, aes(x=law, y=DriversKilled )) + geom_boxplot()
plot3
plot3 <- ggplot(df, aes(x=law, y=DriversKilled )) + geom_boxplot()
library(tidyverse)
df <- Seatbelts
df <- data.frame(df)
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20)
df <- data.frame(as.matrix(Seatbelts), date=time(Seatbelts))
df$year <- trunc(df$date)
df$month <- (df$date - df$year) * 12 + 1
df_short = filter(df, date>=1983)
df_short <- mutate(df_short, time = year + rep(month.abb,2))
plot2_short <- ggplot(data=df_short, mapping = aes(x=year, y=DriversKilled)) + geom_line()
plot3 <- ggplot(df, aes(x=law, y=DriversKilled )) + geom_boxplot()
plot3
library(tidyverse)
df <- Seatbelts
df <- data.frame(df)
plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20)
df <- data.frame(as.matrix(Seatbelts), date=time(Seatbelts))
df$year <- trunc(df$date)
df$month <- (df$date - df$year) * 12 + 1
df_short = filter(df, date>=1983)
df_short <- mutate(df_short, time = year + rep(month.abb,2))
plot2_short <- ggplot(data=df_short, mapping = aes(x=year, y=DriversKilled)) + geom_line()
plot3 <- ggplot(df, aes(x=law, y=DriversKilled )) + geom_boxplot()
plot3
plot3 <- ggplot(df, aes(x=law, y=DriversKilled, color=law)) + geom_boxplot()
plot3
df_short
?sample
dft < gather(df, "Die", 'value', -Roll)
dft <- gather(df, "Die", 'value', -Roll)
library(tidyr)
dft <- gather(df, "Die", 'value', -Roll)
library(tidyverse)
library(nycflights13)
rolls<-10 #Number of rolls
df<-data.frame(D1 = sample(1:6,rolls,replace = TRUE),
D2 = sample(1:6,rolls,replace = TRUE),
D3= sample(1:6,rolls,replace = TRUE),
D4 = sample(1:6,rolls,replace = TRUE),
D5 = sample(1:6,rolls,replace = TRUE))
df$Roll<-1:rolls #add indicator for roll number
library(tidyr)
dft <- gather(df, "Die", 'value', -Roll)
dft
?gather
dft <- df %>% gather('Die','Value',-Roll)
dft
dfs
dfs <- dft %>% group_by(Roll,Value) %>% summarise(Die_Count = length(value))
library(tidyverse)
library(nycflights13)
rolls<-10 #Number of rolls
df<-data.frame(D1 = sample(1:6,rolls,replace = TRUE),
D2 = sample(1:6,rolls,replace = TRUE),
D3= sample(1:6,rolls,replace = TRUE),
D4 = sample(1:6,rolls,replace = TRUE),
D5 = sample(1:6,rolls,replace = TRUE))
df$Roll<-1:rolls #add indicator for roll number
library(tidyr)
dft <- gather(df, "Die", 'value', -Roll)
dft <- df %>% gather('Die','Value',-Roll)
dfs <- dft %>% group_by(Roll,Value) %>% summarise(Die_Count = length(Value))
dfs
View(dfs)
dfs <- dft %>% group_by(Roll,Value) %>% summarise(Die_Count = n(Value))
library(tidyverse)
library(nycflights13)
rolls<-10 #Number of rolls
df<-data.frame(D1 = sample(1:6,rolls,replace = TRUE),
D2 = sample(1:6,rolls,replace = TRUE),
D3= sample(1:6,rolls,replace = TRUE),
D4 = sample(1:6,rolls,replace = TRUE),
D5 = sample(1:6,rolls,replace = TRUE))
df$Roll<-1:rolls #add indicator for roll number
library(tidyr)
dft <- gather(df, "Die", 'value', -Roll)
dft <- df %>% gather('Die','Value',-Roll)
dfs <- dft %>% group_by(Roll,Value) %>% summarise(Die_Count = n(Value))
dfs <- dft %>% group_by(Roll,Value) %>% summarise(Die_Count = n())
dfs
df$Keep <- dfs$Die_Count == dfs$Max_Die_Count
max(c(1,4,5))
p2_move <- function(strategy, pools, p1_move) {
if (strategy == 1){
p2_moving <- p1_move + 1
while (!(p2_moving %in% pools)) {
if (p2_moving <= 9){
p2_moving <- p2_moving + 1
}else{
p2_moving <- 1
}
else if (strategy == 2){
p2_moving <- max(pools)
}
return(p2_moving)
}
play <- function(time, strategy){
pools <- c(1,2,3,4,5,6,7,8,9)
#first move
p1_first_move <- sample(pools,1)
pools <- pools[pools != p1_first_move]
p2_first_move <- p2_move(strategy, pools,p1_first_move)
pools <- pools[pools != p2_first_move]
#second_move
p1_second_move <- sample(pools,1)
pools <- pools[pools != p1_second_move]
p2_second_move <- p2_move(strategy, pools,p1_second_move)
pools <- pools[pools != p2_second_move]
#third_move
p1_third_move <- sample(pools,1)
pools <- pools[pools != p1_third_move]
p2_third_move <- p2_move(strategy, pools, p1_third_move)
pools <- pools[pools != p2_third_move]
#p1 and p2 moves:
p1 <- c(p1_first_move, p1_second_move, p1_third_move)
p2 <- c(p2_first_move, p2_second_move, p2_third_move)
row <- data.frame("time"=time,"player1"=p1, "player2"=p2)
return(row)
}
game <- function(time=1:1000, strategy){
df <- data.frame()
for (i in time){
df <- rbind(df, play(i, strategy))
}
# Group and Summarise player 1 and player 2 moves
df <- df %>% group_by(time) %>% summarise(player1=paste(player1, collapse = ''), player2=paste(player2, collapse = ''))
# Convert to numeric value
df$player1 <- as.numeric(df$player1)
df$player2 <- as.numeric(df$player2)
return(df)
}
# Setup the game
df <- game(strategy = 1)
game <- function(time=1:1000, strategy){
library(dplyr)
df <- data.frame()
for (i in time){
df <- rbind(df, play(i, strategy))
}
# Group and Summarise player 1 and player 2 moves
df <- df %>% group_by(time) %>% summarise(player1=paste(player1, collapse = ''), player2=paste(player2, collapse = ''))
# Convert to numeric value
df$player1 <- as.numeric(df$player1)
df$player2 <- as.numeric(df$player2)
return(df)
}
# Setup the game
df <- game(strategy = 1)
View(df)
# Create winner column, this step is really painful btw. You might argue that why didn't I put it into the game function but I prefer putting it outside, cause I don't want to pass another function as parameter in to the game function. Crowded enough!
df$winner <- mapply(FUN = win_check, player1=df$player1, player2=df$player2)
p2_move <- function(strategy, pools, p1_move) {
if (strategy == 1){
p2_moving <- p1_move + 1
while (!(p2_moving %in% pools)) {
if (p2_moving <= 9){
p2_moving <- p2_moving + 1
}else{
p2_moving <- 1
}
else if (strategy == 2){
p2_moving <- max(pools)
}
return(p2_moving)
}
# First 3 moves for each player
play <- function(time, strategy){
pools <- c(1,2,3,4,5,6,7,8,9)
#first move
p1_first_move <- sample(pools,1)
pools <- pools[pools != p1_first_move]
p2_first_move <- p2_move(strategy, pools,p1_first_move)
pools <- pools[pools != p2_first_move]
#second_move
p1_second_move <- sample(pools,1)
pools <- pools[pools != p1_second_move]
p2_second_move <- p2_move(strategy, pools,p1_second_move)
pools <- pools[pools != p2_second_move]
#third_move
p1_third_move <- sample(pools,1)
pools <- pools[pools != p1_third_move]
p2_third_move <- p2_move(strategy, pools, p1_third_move)
pools <- pools[pools != p2_third_move]
#p1 and p2 moves:
p1 <- c(p1_first_move, p1_second_move, p1_third_move)
p2 <- c(p2_first_move, p2_second_move, p2_third_move)
row <- data.frame("time"=time,"player1"=p1, "player2"=p2)
return(row)
}
# Check whether or not there is winner. This is used for creating another winner column for our dataframe
win_check <- function(player1,player2) {
win_list <- c(123,132,213,231,312,321,
456,465,546,564,645,654,
789,798,879,897,978,987,
147,174,417,471,741,714,
258,285,528,582,825,852,
369,396,639,693,936,963,
159,195,519,591,915,951,
357,375,537,573,735,753)
if(player1 %in% win_list){
return('P1')
}else if(player2 %in% win_list){
return('P2')
}else{
return('Draw')
}
# Game function. Run the game function to create the dataframe
game <- function(time=1:1000, strategy){
library(dplyr)
df <- data.frame()
for (i in time){
df <- rbind(df, play(i, strategy))
}
# Group and Summarise player 1 and player 2 moves
df <- df %>% group_by(time) %>% summarise(player1=paste(player1, collapse = ''), player2=paste(player2, collapse = ''))
# Convert to numeric value
df$player1 <- as.numeric(df$player1)
df$player2 <- as.numeric(df$player2)
df$winner <- mapply(FUN = win_check, player1=df$player1, player2=df$player2)
return(df)
}
# Setup the game
df <- game(strategy = 1)
# Let's see the result
result <- df %>% group_by(winner) %>% summarise(count=n()) %>% mutate(percentage=percent(count/sum(count)))
(scales)
library(scales)
# Let's see the result
result <- df %>% group_by(winner) %>% summarise(count=n()) %>% mutate(percentage=percent(count/sum(count)))
result
set.seed(10)
# Setup the game
df <- game(strategy = 1)
# Let's see the result
result <- df %>% group_by(winner) %>% summarise(count=n()) %>% mutate(percentage=percent(count/sum(count)))
result
df <- game(strategy = 2)
View(df)
set.seed(10)
# function for player 2 to move
p2_move <- function(strategy, pools, p1_move) {
if (strategy == 1){
p2_moving <- p1_move + 1
while (!(p2_moving %in% pools)) {
if (p2_moving <= 9){
p2_moving <- p2_moving + 1
}else{
p2_moving <- 1
}
else if (strategy == 2){
p2_moving <- max(pools)
}
return(p2_moving)
}
# First 3 moves for each player
play <- function(time, strategy){
pools <- c(1,2,3,4,5,6,7,8,9)
#first move
p1_first_move <- sample(pools,1)
pools <- pools[pools != p1_first_move]
p2_first_move <- p2_move(strategy, pools,p1_first_move)
pools <- pools[pools != p2_first_move]
#second_move
p1_second_move <- sample(pools,1)
pools <- pools[pools != p1_second_move]
p2_second_move <- p2_move(strategy, pools,p1_second_move)
pools <- pools[pools != p2_second_move]
#third_move
p1_third_move <- sample(pools,1)
pools <- pools[pools != p1_third_move]
p2_third_move <- p2_move(strategy, pools, p1_third_move)
pools <- pools[pools != p2_third_move]
#p1 and p2 moves:
p1 <- c(p1_first_move, p1_second_move, p1_third_move)
p2 <- c(p2_first_move, p2_second_move, p2_third_move)
row <- data.frame("time"=time,"player1"=p1, "player2"=p2)
return(row)
}
# Check whether or not there is winner. This is used for creating another winner column for our dataframe
win_check <- function(player1,player2) {
win_list <- c(123,132,213,231,312,321,
456,465,546,564,645,654,
789,798,879,897,978,987,
147,174,417,471,741,714,
258,285,528,582,825,852,
369,396,639,693,936,963,
159,195,519,591,915,951,
357,375,537,573,735,753)
if(player1 %in% win_list){
return('P1')
}else if(player2 %in% win_list){
return('P2')
}else{
return('Draw')
}
# Game function. Run the game function to create the dataframe
game <- function(time=1:1000, strategy){
library(dplyr)
df <- data.frame()
for (i in time){
df <- rbind(df, play(i, strategy))
}
# Group and Summarise player 1 and player 2 moves
df <- df %>% group_by(time) %>% summarise(player1=paste(player1, collapse = ''), player2=paste(player2, collapse = ''))
# Convert to numeric value
df$player1 <- as.numeric(df$player1)
df$player2 <- as.numeric(df$player2)
df$winner <- mapply(FUN = win_check, player1=df$player1, player2=df$player2)
return(df)
}
# Setup the game
df <- game(strategy = 1)
# Let's see the result
result <- df %>% group_by(winner) %>% summarise(count=n()) %>% mutate(percentage=percent(count/sum(count)))
result
df <- game(strategy = 2)
# Let's see the result
result <- df %>% group_by(winner) %>% summarise(count=n()) %>% mutate(percentage=percent(count/sum(count)))
result
