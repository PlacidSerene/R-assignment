---
title: "Project1"
author: "Daniel Nguyen"
date: "9/19/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Project 1: Seatbelt 

Description: 

UKDriverDeaths is a time series giving the monthly totals of car drivers in Great Britain killed or seriously injured Jan 1969 to Dec 1984. Compulsory wearing of seat belts was introduced on 31 Jan 1983.
Seatbelts is more information on the same problem.

### Setup

```{r}
library(tidyverse)
# Since it's  time series, we need to convert it into a dataframe
df <- data.frame(as.matrix(Seatbelts), date=time(Seatbelts))
df$year <- trunc(df$date)
df$month <- (df$date - df$year) * 12 + 1
# Create our graph for driverskilled

plot1 <- ggplot(data=df, mapping = aes(x=DriversKilled)) +geom_histogram(bins = 20) #distribution
plot2 <- ggplot(data=df, mapping = aes(x=date, y=DriversKilled)) + geom_line()


# filter our data
df_short = filter(df, date>=1983)
plot2_short <- ggplot(data=df_short, mapping = aes(x=date, y=DriversKilled)) + geom_line()

# descriptive statistic
#mean
mean_death = mean(df$DriversKilled)
#max
max_death = max(df$DriversKilled)
max_df_date = select(filter(df, DriversKilled==max_death), year, month)
#min
min_death = min(df$DriversKilled)
min_df_date = select(filter(df, DriversKilled==min_death), year, month)
#median
median_death = median(df$DriversKilled)
```





### Examine the number of deaths from 1969 - 1984

I'm trying to see the distribution in the number of drivers killed in accidents from 1969 to 1984. Let's see our plot

```{r}
plot1
```

From the plot, we could see that the plot is normal distributed. It's easy to see that the number of drivers killed each month from car accidents mostly varies from 100 to 150 people a month.

Let's see another chart to see how it


```{r}
plot2
```

It looks like there is a significant drop around 1983, let's investigate what's the cause of it. And the answer for it is the requirement for wearing seat belt in January 31st 1983. Let's investigate further.

```{r}
plot2_short
```

I have filtered out the year before 1983 for the graph above. After new policy released, it seems like it's effective for sometimes then quickly going back to normal after several months.


# Descriptive Statistics

Let's see the mean, max, min, median, etc

1. Average number of deaths per month: `r mean_death`

2. Most deaths in a month: `r max_death` 
```{r}
max_df_date
```
3. Least deaths in a month: `r min_death` in 
```{r}
min_df_date
```
4. Median: `r median_death`

